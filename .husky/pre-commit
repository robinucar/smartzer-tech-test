#!/usr/bin/env sh

echo "ğŸ” Husky pre-commit hook triggered"

echo "ğŸ” Running lint..."
if ! npm run lint; then
  echo "âŒ Lint failed. Commit aborted."
  exit 1
fi

echo "ğŸ§¹ Formatting staged files..."
if ! npx pretty-quick --staged; then
  echo "âŒ Formatting failed. Commit aborted."
  exit 1
fi

echo "ğŸ§ª Running tests..."
if ! npm test; then
  echo "âŒ Tests failed. Commit aborted."
  exit 1
fi

echo "ğŸ›¡ï¸ Running security audit CVE scan..."
if ! npm audit --audit-level=high; then
  echo "âŒ Security vulnerabilities found. Commit aborted."
  exit 1
fi

echo "âœ… All checks passed. Proceeding with commit."
echo "ğŸ§¼ Husky pre-commit hook completed"
