#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

set -e

echo "ğŸ” Husky pre-commit hook triggered"

echo "ğŸ” Running lint..."
npm run lint

echo "ğŸ§¹ Formatting staged files..."
npx pretty-quick --staged

echo "ğŸ§ª Running tests..."
npm test

echo "ğŸ›¡ï¸ Running security audit CVE scan..."
npm audit --audit-level=high || {
  echo "âŒ Security vulnerabilities found. Commit aborted."
  exit 1
}

echo "âœ… All checks passed. Proceeding with commit."
echo "ğŸ” Husky pre-commit hook completed"